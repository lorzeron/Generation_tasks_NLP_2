# Generation_tasks_NLP_2

## Чат-бот "Доктор Хаус"

**Описание проекта:**  
Проект представляет собой чат-бота, имитирующего стиль общения доктора Хауса из одноимённого сериала. В этой версии используется генеративный подход с fine‑tuning модели DistilGPT2, что позволяет генерировать уникальные ответы с учетом истории диалога и обеспечивает более естественное и последовательное общение.

---

## Используемые данные

- **Источник данных:** Транскрипты первого сезона сериала "Доктор Хаус" (файл `season1.csv`).
- **Структура данных:**
  - `line` — текст реплики
  - `name` — имя персонажа

**Пример данных:**
   - "That you know of.",House
   - "The color?",House

---

## Предобработка данных

- **Фильтрация:** Оставлены только реплики персонажа Хауса.
- **Очистка текста:**
  - Удаление текста в квадратных скобках
  - Приведение к нижнему регистру.
  - Удаление стоп-слов (на английском языке).
  - Удаление цифр, пунктуации и HTML‑тегов.
- **Результат:** Очищенные данные сохранены в файл `data/dialogues_clean.csv`.

---

## Обучение модели

- **Метод:** Генеративный подход с fine‑tuning модели DistilGPT2.
- **Процесс:**
  1. Объединение очищенных реплик в единый текст для обучения.
  2. Fine‑tuning модели DistilGPT2 на подготовленных данных с использованием Hugging Face Transformers, Datasets и PyTorch.
  3. Сохранение дообученной модели в папку `generative_model`.
- **Визуализация:** Во время обучения используется progress bar (tqdm) для отслеживания процесса.

---

## Инференс модели

- **Логика работы:**
  1. При получении запроса формируется промпт с учетом истории диалога.
  2. Дообученная модель генерирует ответ с ограничением числа новых токенов и параметрами, предотвращающими повторения.
  3. Из сгенерированного текста извлекается ответ бота.
- **Пример работы:**
  - **Запрос:** "hello"
  - **Бот:** генерирует ответ в стиле доктора Хауса (например, "Hello!").

---

## Веб-интерфейс

- **Фреймворк:** FastAPI с простым HTML‑интерфейсом.
- **Описание:** Веб‑сервис предоставляет страницу с окном чата, где можно вводить сообщения и получать ответы от бота, при этом история диалога учитывается для генерации ответов.
- **Запуск:**
  - Запустите веб‑сервис командой:
    ```bash
    uvicorn app:app --host 0.0.0.0 --port 8001 --reload
    ```
  - Откройте браузер по адресу [http://0.0.0.0:8001](http://0.0.0.0:8001) для общения с ботом.

---

## Установка и запуск

1. **Установка зависимостей:**
   ```bash
   pip install -r requirements.txt
2. **Подготовка данных:**
    ```bash
   python preprocess.py
3. **Обучение генеративной модели:**
    ```bash
   python train_generative_model.py --epochs 3 --batch_size 4
4. **Запуск веб‑сервиса:**
    ```bash
    uvicorn app:app --host 0.0.0.0 --port 8001 --reload


## Структура проекта 
  
    Generation_tasks_NLP/
    ├── data/                    
    │   ├── dialogues_clean.csv   # Очищенные диалоги
    │   └── season1.csv           # Данные первого сезона
    ├── generative_model/         # Дообученная генеративная модель (DistilGPT2)
    ├── plots/                   # (опционально) графики и визуализации
    ├── benchmark.py             # Скрипт для оценки производительности (опционально)
    ├── inference.py             # Код для инференса модели с генеративным подходом
    ├── preprocess.py            # Скрипт предобработки данных
    ├── requirements.txt         # Зависимости проекта
    ├── train_generative_model.py# Код для обучения генеративной модели
    └── app.py                   # FastAPI веб-сервис с простым HTML‑интерфейсом
## Итеративный процесс улучшений
  
    Baseline: Первая версия была основана на retrieval-based методе (TF‑IDF + косинусное сходство), который выбирал реплику из фиксированного набора данных, что приводило к нерелевантным ответам.

    Улучшение 1: Переход на генеративный подход с fine‑tuning DistilGPT2 для создания уникальных ответов в стиле доктора Хауса.
  
    Улучшение 2: Реализация механизма учета истории диалога, что обеспечивает более последовательное и контекстное общение.

    Улучшение 3: Добавление веб‑сервиса на FastAPI с простым HTML‑интерфейсом для удобного взаимодействия с ботом.








